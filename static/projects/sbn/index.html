<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#6366f1" />
  <meta name="description" content="مستعمل حوا - شبكة الأعمال الاجتماعية | منصتك للتجارة والخدمات والمعرفة" />

  <!-- PWA Support -->
  <link rel="manifest" href="./manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="مستعمل حوا" />

  <title>مستعمل حوا - Mostamal Hawa | منصة التجارة والخدمات</title>

  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      /* بسم الله الرحمن الرحيم */
      color-scheme: light dark;

      /* Brand Colors */
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #818cf8;
      --secondary: #ec4899;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #3b82f6;
    }

    /* Light Theme (Default) */
    :root[data-theme='light'] {
      --bg-body: #f8fafc;
      --bg-card: #ffffff;
      --bg-hover: #f1f5f9;
      --bg-active: #e2e8f0;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #94a3b8;
      --border: #e2e8f0;
      --shadow: rgba(15, 23, 42, 0.08);
    }

    /* Dark Theme */
    :root[data-theme='dark'] {
      color-scheme: dark;
      --bg-body: #0f172a;
      --bg-card: #1e293b;
      --bg-hover: #334155;
      --bg-active: #475569;
      --text-primary: #f1f5f9;
      --text-secondary: #cbd5e1;
      --text-tertiary: #94a3b8;
      --border: #334155;
      --shadow: rgba(0, 0, 0, 0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Cairo', 'Tajawal', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-body);
      color: var(--text-primary);
      transition: background-color 0.3s ease, color 0.3s ease;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    #app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Hide scrollbar but keep functionality */
    ::-webkit-scrollbar {
      width: 0px;
      height: 0px;
      background: transparent;
    }

    /* Loading Screen */
    .loading-overlay {
      position: fixed;
      inset: 0;
      background: var(--bg-body);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      flex-direction: column;
      gap: 20px;
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      color: var(--text-secondary);
      font-size: 16px;
      font-weight: 500;
    }

    /* Responsive Typography */
    h1 { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 700; }
    h2 { font-size: clamp(1.25rem, 3.5vw, 1.75rem); font-weight: 600; }
    h3 { font-size: clamp(1.125rem, 3vw, 1.5rem); font-weight: 600; }
    h4 { font-size: clamp(1rem, 2.5vw, 1.25rem); font-weight: 500; }
    p { font-size: clamp(0.875rem, 2vw, 1rem); line-height: 1.6; }

    /* Smooth transitions */
    button, a, input, select, textarea {
      transition: all 0.2s ease;
    }

    /* Focus styles for accessibility */
    *:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }

    /* Safe area for notch devices */
    @supports (padding: max(0px)) {
      body {
        padding-left: max(0px, env(safe-area-inset-left));
        padding-right: max(0px, env(safe-area-inset-right));
      }
    }

    /* Print styles */
    @media print {
      .no-print {
        display: none !important;
      }
    }

    /* Reduce motion for accessibility */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>

  <!-- Mishkah Framework - Single Unified Build -->
  <script
    src="../../lib/mishkah.js"
    data-auto="true"
    data-css="tailwind"
    data-pwa-storage="sbn:pwa:installed"
    data-stores="true"
  ></script>
</head>
<body>
  <div id="app">
    <!-- Initial loading screen (will be replaced by app) -->
    <div class="loading-overlay">
      <div class="spinner"></div>
      <p class="loading-text">جاري التحميل...</p>
    </div>
  </div>

  <!-- Application Logic -->
  <script src="./app.js"></script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('./sw.js')
          .then(function(registration) {
            console.log('[SBN PWA] Service Worker registered:', registration.scope);
          })
          .catch(function(error) {
            console.warn('[SBN PWA] Service Worker registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>
